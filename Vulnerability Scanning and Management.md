###### Written by Tyler Weiss
### Exercise 1 - Installation
We are going to use Git in this exercise. Git is a version control software that tracks changes and versions of code. It allows multiple developers to manage the software development process to include code review, integration, versioning, merging and tracking. To check if git is installed use the '--versions' flag. If git is not installed use 'apt' to install it. 
![[Pasted image 20240414190435.png]]
```
sudo apt update 
sudo apt install git
```
Using the 'clone' option will allow us pull down, or clone, a a repository to use on our local machine.
```
Example
git clone https://github.com/example/repo.git
```
#### Task 1
We will be deploying the “vulnscan” – Vulnerability Scanning with Nmap Scanner to run alongside nmap on your Ubuntu Server. This is an open source tool and highly effective. It won’t be as pretty or build nice reports like the paid vendor tools, but it gets the job done. 

Use the 'find' command the locate the nmap executable in file system. Below is a link to a tutorial on the 'find' command.
https://www.digitalocean.com/community/tutorials/how-to-use-find-and-locate-to-search-for-files-on-linux

The name option will allow us to search for any file names matching the argument. Use the '-name' option to search for 'nmap'. Sudo may be required to search for file and directories that our user does not have permission to view. If nmap is not installed use 'apt' to install it. 
![[Pasted image 20240414192456.png]]
```
sudo find / -name nmap 
```
![[Pasted image 20240414192726.png]]
The folder nmap is located is '/usr/share/nmap'.

When you read the instructions to install VULNSCAN, it states: “Please install the files into the following folder of your Nmap installation: Nmap\scripts\vulscan\*”.
Navigate to the scripts folder in the nmap directory and list the contents.
![[Pasted image 20240414193137.png]]

Once in the directory we need to download the vulscan project to the scripts directory. To do this use the following commands.
```
git clone https://github.com/scipag/vulscan scipag_vulscan 
sudo ln -s `pwd`/scipag_vulscan /usr/share/nmap/scripts/vulscan
```
The first command clone the repository places it in a directory called 'scipag_vulscan'. The second command creates a symbolic link so that the script can be run from any location in the file system. 
![[Pasted image 20240414194006.png]]
![[Pasted image 20240414194026.png]]

Navigate to the 'scipag_vulscan' directory and list the contents. The vulnerabilty scanner should be ready to use with nmap. Change directories back to the home directory.
![[Pasted image 20240414194654.png]]

Nmap can run scripts by using the '--scripts=\<script\>' option. Run the following command to use the vulnerability scanner. 
```
sudo nmap -sV --script=vulscan/vulscan.nse scanme.nmap.org
```

The vulnerability scanner will use pre-installed databases to generate results.
The following pre-installed databases are available at the moment:
- scipvuldb.csv - https://vuldb.com 
- cve.csv - https://cve.mitre.org 
- securityfocus.csv - https://www.securityfocus.com/bid/ 
- xforce.csv - https://exchange.xforce.ibmcloud.com/ 
- expliotdb.csv - https://www.exploit-db.com 
- openvas.csv - http://www.openvas.org 
- securitytracker.csv - https://www.securitytracker.com (end-of-life) 
- osvdb.csv - http://www.osvdb.org (end-of-life
![[Pasted image 20240414195520.png]]

Since there is a ton of input we should redirect the results to a file. This allows us to view and search the results more easily. Run the script again and save the output to 'scanme.nmap.org_vulnscan'.
```
sudo nmap -sV --script=vulscan/vulscan.nse scanme.nmap.org > scanme.nmap.org_vulnscan
```
![[Pasted image 20240414200111.png]]

Now run a vulnerability scan on your local network using the following command and redirect the output to a file. Spend some time reviewing the scan results.
```
nmap -sV --script=vulscan/vulscan.nse <your network ID and CIDR> 
```
![[Pasted image 20240414200746.png]]
![[Pasted image 20240414200825.png]]

Lets run a scan against a purposely vulnerable machine. We will be downloading a version of Linux called “DamnVulnerableLinux”. You’ll never be “INSTALLING” the DVL operating system. You just boot to the ISO to make it work.

You can follow this walk through if you want:
https://www.computersecuritystudent.com/SECURITY_TOOLS/DVL/lesson1/index.html

Download DVL 1.5 
https://download.vulnhub.com/dvl/DVL_1.5_Infectious_Disease.iso

1. Create a NEW VM 
2. Load the ISO into the VM 
3. Set the memory to 512m 
4. Set 1 Core of CPU 
5. 8gb for Storage 
6. Set Networking to BRIDGED 
7. When you see BOOT: in the CLI, just hit the ENTER KEY 
	1. a. This will boot you into the DVL 
8. Username will be root 
9. Password will be toor

![[Pasted image 20240414202024.png]]
![[Pasted image 20240414202100.png]]
![[Pasted image 20240414202129.png]]
![[Pasted image 20240414202218.png]]
![[Pasted image 20240414202248.png]]
![[Pasted image 20240414202548.png]]
![[Pasted image 20240414202643.png]]


Once downloaded and the VM is setup use 'ifconfig' to find the IP addresss for the DVL. Run the vulnerability scanner against the IP address you just located. Review the output of the scan.
```
nmap -sV --script=vulscan/vulscan.nse <your DVL ip address>
```
![[Pasted image 20240414202913.png]]

Run the command again and save the output to a file. Identify 3 vulnerabilities and generate a short executive summary on each.
![[Pasted image 20240414203029.png]]
![[Pasted image 20240414203054.png]]

#### Vulnerabilities Discovered (3)

The out of date CUPS service allows a certain crafted UDP packet over IPP that causes a DoS, or service hang, to occur. Even though the impact of this attack is low the execution of the attack is easy to perform. The probability of this attack taking place in the near future is almost zero. This issue is best resolved by installing the latest version of CUPS.
Solution: Update CUPS at https://www.cups.org/
![[Pasted image 20240414211429.png]]
![[Pasted image 20240414223229.png]]
![[Pasted image 20240414223258.png]]
![[Pasted image 20240414223330.png]]
![[Pasted image 20240414223159.png]]

The XAMPP default accounts are using using default credentials. XAMPP is a web server solution stack package. An attacker can find these credentials via a basic internet search and gain access or information regarding the different services. The default credentials are listed below in the screen capture. This attack is trivial to perform and could possibly lead to major network compromise or data loss. The probability of this attack occurring is very low but is easy to resolve. The solution is to find any default credentials installed deployed by XAMPP and update them.
Solution: Audit the accounts via XAMPP and update using strong, complicated passwords. There should be no default credentials.
![[Pasted image 20240414211641.png]]
![[Pasted image 20240414223439.png]]
![[Pasted image 20240414223506.png]]

A SQL injection is possible by sending a SQL statement to the index.php script using the id_kat parameter in the PHPWebNews plugin. It is extremely easy to exploit this vulnerability and could cause data loss or manipulation. The impact of this attack high and could easily lead to leaked/stolen credentials. Below is a screen shot of a publicly available exploit designed to steel usernames and password hashes. This vulnerability effects PHPWebNew 0.1-0.2. The probability of this exploit being seen in the near future very low but it could have serious consequences. As of yet there is no update for the plugin to resolve the issue. My recommendatio is to discontue use of the PHPWebNews plugin.
Solution: Discontinue use of PHPWebNews plugin.
![[Pasted image 20240414211747.png]]
![[Pasted image 20240414223703.png]]
![[Pasted image 20240414223552.png]]
![[Pasted image 20240416233011.png]]
![[Pasted image 20240414223615.png]]
![[Pasted image 20240414223749.png]]
https://www.exploit-db.com/exploits/5998

### Exercise 2 - 
#### Task 1 - Download Nessus Installer
From your Host OS, navigate in your browser to https://www.tenable.com/downloads/nessus?loginAttempted=true.
Select Nessus 10.7.0 on the Linux – Ubuntu – amd64 Platform
![[Pasted image 20240414224702.png]]
Once the installer file is downloaded to your host machine we need to use 'scp' to copy the file to the Linux server that we will use to run Nessus.

#### Task 2 - Clone Ubuntu Server
First thing we are going to do is CLONE your Ubuntu Server VM from its original CLEAN snapshot.
By creating a "Golden State" snapshot of a VM it is trivial and quick to create a clone. The new VM should only take a few minutes to clone and run. 

1. Load up the Virtual Box VirtualBox Manager 
2. Power off all VM’s in Virtual Box 
3. Select the Ubuntu Server VM object on the left hand side
	1. Select the button on the right hand side and have the snapshots loaded in the details pane.
![[Pasted image 20240414225823.png]]

4. Select a snapshot, in the right-side window, that is the best clean installation you have.
5. Once selected click the 'Clone' button with the sheep.
6. Rename the new VM something along the lines of "Ubuntu Vulnerability Scanner" and click 'Next'.
![[Pasted image 20240414230357.png]]

7. Make sure 'Full clone' is selected and click 'Next'.
![[Pasted image 20240414230507.png]]

8. Select 'Current machine state' and click 'Finish'.
![[Pasted image 20240414230703.png]]

This will create a clean image of your server. The clone will take only a minute to deploy. This is how IT professionals are able to spin-up new systems in minutes reliably. Double check that all the settings for the cloned server are correct. They should be the same as the original VM but if you need to make changes this is also the time to do that. 

#### Task 3 
Prerequisites:
- Ubuntu Server 22.04 Installed, Updated, Upgraded and running in Virtual Box 
- Ubuntu Guest VM Networking settings is set to Bridged Mode in Virtual Box 
- The Ubuntu Guest VM is running 
- Have an open CLI in your HOST OS, and test that you can SSH into the Guest VM

Powerup your new VM and ssh into the server via your Host terminal. Pull up another command prompt and navigate to the location of the nessus installer file you downloaded in task 1. List the contents of the directory to prove that the file is there. Now 'scp' the file to the Linux server. If you need a reference for using 'scp' use the link below.
https://linuxize.com/post/how-to-use-scp-command-to-securely-transfer-files/

![[Pasted image 20240414234555.png]]
![[Pasted image 20240414234713.png]]
![[Pasted image 20240414234755.png]]

#### Task 4
The .deb file is not executable and needs it's permissions modified so that we can run the installer. This is due to the fact that the file was downloaded over the internet and Linux is protecting us from executing it immediately after download. Use 'chmod +x \<file\>' to add execute permissions to the file. 
![[Pasted image 20240415002552.png]]

It's time to install and setup the Nessus vulnerability scanner. We'll use the following walkthrough as a reference for installation.
https://docs.tenable.com/nessus/Content/InstallNessusLinux.htm

The install guide above requires the use of 'dpkg' to install the .deb file. With 'dpkg' there are a couple flags you will probably use when installing a program. The first is the '-i' flag which means install. The '-r' flag removes, or uninstalls, a program. To list installed packages use the '-l' flag. When listing packages there are quite a few of them so use grep to display only packages you are interested in. If you are having dependency issues try running 'sudo apt install -f' which will attempt to fix broken dependencies. 

Use 'dpkg -i' to install Nessus.
![[Pasted image 20240415004213.png]]
![[Pasted image 20240415004304.png]]

All the setup processes should read pass, especially INSTALL. If that is true then you have successfully installed Nessus. At the bottom of the output you see that the Nessus service needs to be started. Also to configure and run Nessus you will need to navigate to the serving IP specifying port '8834'. 

In order to start the service we need to use 'systemctl'. Use the 'start' option to begin the 'nessus' service. You will need to use root permissions to start the service. Check the status of the service after starting it to confirm that the nessus service is running.
![[Pasted image 20240415005258.png]]

It appears that nessus is active and running. We need to navigate to the nessus browser interface over https on port 8834. Open the browser and navigate to 'https://<server ip\>:8834'. 
![[Pasted image 20240415005704.png]]

You should see a page that says 'Your connection is not private'. All this means is that we do not have a valid digital certificate. This is just a warning and since we are no going to go through the trouble of validating a cert for the local server we can ignore this. Click the 'Advanced' button and then click the link 'Proceed to \<IP\> (unsafe)' . 
![[Pasted image 20240415005916.png]]

You should see a welcome screen like the one below. But before you continue you need to register an account with tenable for a an "Essentials Edition" of Nessus so that you can obtain a product key. This license can not be used for commercially by the way, it's just for educational purposes. 
![[Pasted image 20240415010350.png]]

Register an educational account here: 
https://www.tenable.com/tenable-for-education/nessus-essentials?edu=true

![[Pasted image 20240415011427.png]]

You should recieve an email from Tennable that has your activation code.
![[Pasted image 20240415011850.png]]

Go back to the nessus web interface and click 'Next'. Select the radio button that says 'Nessus Essentials' and click 'Next'. Register if you have not already and click 'Next'. Enter you activation code and click 'Continue'. 
![[Pasted image 20240415012155.png]]
![[Pasted image 20240415012420.png]]

Create a local user account by filling in the account information and click 'Submit'. These are the credentials you will use to sign in to your Nessus interface in the browser.
![[Pasted image 20240415012712.png]]

Nessus will begin initializing and starting the setup process. After it is done the dashboard will appear. You should notice a couple rotating arrows in the upper right corner the dashboard. This is because plugins for Nessus are downloading and installing. This may take roughly 30 minutes or so depending on your internet connection. You will have restricted functionality during the install process and can not yet run scans.
![[Pasted image 20240415082529.png]]
![[Pasted image 20240415082658.png]]

When the initial install is finished a popup, like the one below, will appear. This is telling you that setup has completed and you are now able to use Nessus. Also 16 host scan limit for the license. Do not go and scan everything because you will reach this limit very quickly.
![[Pasted image 20240415125126.png]]

### Exercise 3 - Perform a Basic Scan with Nessus
#### Task 1 - Conduct your first Vulnerability Scan (Home Network)
The first scan we'll conduct of our home network. Click the highlighted text 'Create new scan' under the my scans tab or use the 'New Scan' button. There are many different scans to choose from to include host discovery, basic, advanced, malware, specific vulnerability, and compliance scans. We will you the basic scan in this exercise. Click the 'Basic Network Scan' button and fill out the name of the scan along with the target IP range and description. You can use a list, range or CIDR notation to specify the target IP address. There is also an option to use a file for target input. After you are finished filling out the fields click the 'Save' button.
![[Pasted image 20240415134057.png]]
![[Pasted image 20240415180234.png]]
![[Pasted image 20240415134222.png]]
![[Pasted image 20240415181952.png]]

You should now see the newly created scan under the 'My Scans' folder. The scan object shows the scan name, scheduling, the last time the scan was run, the start on demand button and the delete option. you can schedule a scan to run weekly, daily, monthly, and so on. Automating scans can be very advantageous and a big time saver. Click the play button on the far right to begin the scan.
![[Pasted image 20240415183226.png]]

Here is the output of 'htop' run from the server CLI. You'll notice all the processes and threads from 'nessusd' running while the scan is being performed. 
![[Pasted image 20240415183545.png]]

When the scan is complete a checkmark will appear under the 'Last Scanned' column of the scan object. Click on the scan object to review the results. Under the 'Hosts' tab the vulnerabilities per host are displayed. To the right of the screen you can see the scan details. If you click on a host a list of the list vulnerabilities will be presented specific to that host. The 'vulnerabilities' tab is a list of all vulnerabilities found during the scan. 
![[Pasted image 20240415201020.png]]

Vulnerabilities are listed showing severity, common vulnerability scoring system (CVSS) score, vulnerability priority rating (VPR), the plugin family associated with the vulnerability, and the count. The vulnerability object has edit and snooze buttons. To the right is a the host and small breakdown of its addressing and OS. You can click the column headers to sort the list. CVSS provides the severity rating of the vulnerability and VPR that represent the risk/urgency of a vulnerability considering the current virtual landscape. These two rating can help prioritize fixing vulnerable issues.
![[Pasted image 20240415202047.png]]

If you drill down further by clicking on a vulnerability object the first thing you'll notice is the description and solution along with some reference links. Below that is the output from the plugin that found the vulnerability and some more specifics about the vulnerable vector. To the right details for the plugin that found the vulnerability, the key factors in VPR calculation, the risk information related to CVSS calculation, vulnerability information related to exploitation, and a collection of reference links to related issues. Exploring some the reference links may also be smart move at this point to gain a better understanding of the vulnerability. This may also include tracking down exploits and proof-of-concepts to become fully aware of how the vulnerability is abused.
![[Pasted image 20240415203157.png]]
![[Pasted image 20240415203217.png]]
![[Pasted image 20240415203237.png]]

Navigate back to the hosts tab and generate a report of the scan scan. To do this click the report button at the top right of the page. Select the 'HTML' radio button for the format. The CVS format is for passing data between programs. Select the report template you want. I'll use the default selection for this exercise. When you are done click 'Generate report'. Save the report file to somewhere that makes sense.
![[Pasted image 20240415204612.png]]

The report can opened in the browser for review. This report displays a basic breakdown of vulnerabilities by host. Clicking on the show button under a host displays the vulnerability object list. For more information on a vulnerability, to include all the details previously found in the Nessus interface, click on the plugin link. This will take you to the associated Nessus plugin page where you can find all the information the vulnerability. This is not the only report template though so perform some scans and generate reports to gain better insight into report generation for specific purposes. For example, you may want to generate different reports for different departments.
![[Pasted image 20240415205330.png]]

#### Task 2 - Conduct your first Vulnerability Scan – DVL
This scan will target a Damn Vulnerable Linux version 1.5 (DVL). Make sure you have a VM deployed of DVL and start it up. I purposely went logged into my DVL instance and started a bunch of services to make the scan more interesting. Use 'ifconfig' to find the local IP address of the DVL VM and make a note of it. We are going to use this IP address as the target for the scan. 
![[Pasted image 20240415212716.png]]

Open up the Nessus interface in the browser by navigating to the server's IP address on port 8834. Click on the 'New Scan' button in the 'My Scans' folder. Select the 'Basic Network Scan' option and fill out the required fields. The target is the DVL IP address that you recorded earlier. Once you are done, click the 'Save' button to create the scan.
![[Pasted image 20240415212450.png]]
![[Pasted image 20240415213154.png]]
![[Pasted image 20240415213426.png]]

The new scan should now appear in the 'My Scans' folder. Click the play button on in the scan object to begin the scan. This is going to take some time so be patient and wait for the checkmark to appear next to the 'Last Scanned' DTG of the scan object.
![[Pasted image 20240415213704.png]]

Remember that you can pause or stop the scan at anytime. Once paused there is an option to resume the scan as well.
![[Pasted image 20240415214228.png]]

**Scan results:**
Below are some snapshots of the scan results. We can observe that there are quite a few vulnerabilities present on the DVL VM. Upon deeper inspection it becomes obvious that many of the services running on the system are out of date. The recommended remediation for most of the these higher severity issues is to update the services to the latest version. In the scan results page of Nessus you'll see that a large amount of vulnerabilities are grouped by service and have a severity label of 'MIXED'. If you drill down into these entries you'll find many critical or high severity issues relating to the same core problem; the service being out of date or not supported. I believe it is fair to say that the DVL instance would be easily exploitable. I spent quite a while digging into each of these issues and found countless available exploits or proof-of-concept write-ups regarding each; far too many to list here. 
![[Pasted image 20240416000449.png]]
![[Pasted image 20240416000541.png]]
![[Pasted image 20240416000756.png]]
![[Pasted image 20240416223828.png]]
