###### Written by Tyler Weiss 19 MAR 2024

#### Exercise 4 - Installing Logwatch

Run 'sudo apt install logwatch -y' to install program
![[Pasted image 20240319084220.png]]
#### Exercise 5 - Basic Service Usage

Create a detailed report on the ssh service, using logwatch, by typing the following command: 'sudo logwatch --service sshd --detail high --range today --output stdout'
![[Pasted image 20240319085214.png]]

#### Exercise 6 Examining Logs Over Date Ranges

The following screen captures show reports produced by different protocols using multiple range and detail settings.
![[Pasted image 20240319091036.png]]
![[Pasted image 20240319091659.png]]
![[Pasted image 20240319092005.png]]

#### Exercise 7 - View/Compare auth.log and logwatch Output

##### Task #1 - Review Raw Log Entries

1. Inspect the raw log entries in '/var/log/auth.log' 
2. Generate a logwatch report for March 19th

Run the command 'sudo less auth.log |grep "Mar 19"' to output the log files for March 19th.
![[Pasted image 20240319134456.png]]

Only the logs from '17:12:00' to present will be analyzed.
![[Pasted image 20240319142720.png]]

Run the command ''sudo logwatch --detail medium --range "since 2024/03/19 17:12:00" --output stdout --ar
chives' to generate a logwatch report within the specified timeline to analyze.
![[Pasted image 20240319141403.png]]
![[Pasted image 20240319143207.png]]

The below list shows some of the correlations between the raw auth.log output and the report generated by logwatch. (matching entries are numbered in the screen captures):
1. Clearly shows that user 'rec0nrat' is logged in on a ssh session.
2.  The 'mv' command was used twice to move image files.
3.  The 'rm' command was used once to delete an image.
4. The 'wget' command was used once to download an image and save it as 'pat.png'

#### Exercise 8 - Syslog in Linux

##### Task #1

1. Configure syslog to send to the host OS

In order to forward syslog to a specific server the configuration file for rsyslog needs to be edited. Configuration files for syslog are located in the '/etc/rsyslog.d/' directory or the file '/etc/rsyslog.conf'. Adding '\*.\*@\<server\>:514' to the end of '/etc/rsyslog.conf' will send syslog to the specified server via UDP over port 514.
![[Pasted image 20240319153239.png]]
![[Pasted image 20240319153449.png]]
![[Pasted image 20240319153521.png]]

The rsyslog service must now be restarted for the changes to take effect.
![[Pasted image 20240319153643.png]]

##### Task #2 - TCPdump

1. Using 'tcpdump', detect syslog traffic by running the following command:
	- `sudo tcpdump -i any udp port 514 -w syslog_traffic.pcap`
	- The command inspects for udp traffic, over any interface, on port 514 and writes the output to a .pcap file.

![[Pasted image 20240319154619.png]]
In order to read the .pcap file 'tcpdump -r \<file\>' must be used.
![[Pasted image 20240319154843.png]]
